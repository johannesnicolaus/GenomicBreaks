% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/coalesce_contigs.R
\name{coalesce_contigs}
\alias{coalesce_contigs}
\title{Algorithm for Coalescing Pairwise Alignments}
\usage{
coalesce_contigs(gr_ob, tol = Inf)
}
\arguments{
\item{gr_ob}{GRanges object of the pairwise alignment, with reference genome as the subject of the GRanges object, and query genome alignment in the metadata column "query".}

\item{tol}{width of gap that will be bridged in coalescing. The gap must be less than or equal to \code{"tol"} in both the reference and query case.}
}
\value{
new GRanges object of similar structure (GRanges main object is reference genome and metadata is query genome) but with a reduced number of alignment fragments due to coalescion.  The returned object is sorted (ignoring strand).
}
\description{
This algorithm take in pairwise alignment, and reduces the number of alignments by coalescing fragments that are within close proximity (user determined). Fragmented alignments can cause artificial breakpoints arising from incorrect basecalls, misassembly and misalignments.
}
\examples{
gb1       <- GenomicRanges::GRanges(c("chr1:100-200:+", "chr1:400-500:+", "chr1:700-800:+"))
gb1$query <- GenomicRanges::GRanges(c("chr1:100-200:+", "chr1:400-500:+", "chr1:700-800:+"))
coalesce_contigs(gb1, 500)
gb2       <- GenomicRanges::GRanges(c("chr1:100-200:-", "chr1:400-500:-", "chr1:700-800:-"))
gb2$query <- GenomicRanges::GRanges(c("chr2:2700-2800:+", "chr2:2400-2500:+", "chr2:2100-2200:+"))
coalesce_contigs(gb2, 500)
gb3       <- GenomicRanges::GRanges(c("chr1:100-200:-", "chr1:400-500:-", "chr1:700-800:-"))
gb3$query <- GenomicRanges::GRanges(c("chr2:2100-2200:+", "chr2:2400-2500:+", "chr2:2700-2800:+"))
coalesce_contigs(gb3, 500)
gb4       <- GenomicRanges::GRanges(c("chr3:100-200:+", "chr3:700-800:+", "chr4:500-600:+"))
gb4$query <- GenomicRanges::GRanges(c("chr7:1100-1200:+", "chr7:1700-1800:+", "chr7:1500-1600:+"))
coalesce_contigs(gb4, 500)
}
